# Appendix B: Homework

The following are six homework assignments for the course. 

## Homework #1

**Due date: Sept. 14**

For your first homework assignment, you'll be working through a few [swirl](http://swirlstats.com/) lessons that are relevant to the material we've covered so far. Swirl is a platform that helps you learn R **in** R - you can complete the lessons right in your R console. 

### Getting started  

First, you'll need to install the swirl package: 

```{r eval=FALSE}
install.packages("swirl")
```

Next, load the swirl package. We're going to download a course from swirl's [course repository](https://github.com/swirldev/swirl_courses) called R Programming E using the function `install_course_github`. Then call the `swirl()` function to enter the interactive platform: 

```{r eval=FALSE}
library(swirl)
uninstall_course("R_Programming_E") # Only run if you have an old version of
                                    # R_Programming_E installed
install_course_github("swirldev", "R_Programming_E")
swirl()
```

```{block, type = 'rmdnote'}
After calling `swirl()`, you may be prompted to clear your workspace variables by running `rm=(list=ls())`. Running this code will clear any variables you already have saved in your global environment. While swirl recommends that you do this, it's not necessary. 
```

### Swirl lessons 

Sign in with your name, and choose *R Programming E* when swirl asks you to choose a course. For this homework, you will need to work through the following lessons in that course (the lesson number is in parentheses): 

- Basic Building Blocks (1)
- Vectors (4)
- Missing Values (5)
- Subsetting Vectors (6)
- Logic (8)
- Looking at Data (12)
- Dates and Times (14)

Each lesson should take about 10-15 minutes, but some are much shorter. You can complete the lessons in any order you want, but you may find it easiest to start with the lowest-numbered lessons and work your way up, in the order we've listed the lessons here. 

You'll be able to get started on some of these lessons after your first day in class (Basic Building Blocks, for example), but others cover topics that we'll get to in weeks 2 and 3. Whether or not we've covered a swirl topic in class, you should be able to successfully work through the lesson. At the end of each lesson, you'll be prompted to "`inform someone about your successful completion of this lesson via email`." after answering `2` for 'Yes,' enter your full name, and enter rachel.severson@colostate.edu as the email address of the person you'd like to notify. You should be sending 7 emails in total. 

```{block, type = 'rmdnote'}
After telling swirl that you would like to send a notification email, an already-populated email should pop up with the lesson you just completed in the subject line - you just need to push send. This might not happen if you access your email through a web browser instead of an app. In this case, just send an email manually with a screenshot of the end of the lesson, and the name of the lesson you just completed. 
```

### Special swirl commands 

In the swirl environment, knowing about the following commands will be helpful:

- Within each lesson, the prompt `...` indicates that you should hit Enter to move on to the next section. 
- `play()`: temporarily exit swirl. It can be useful during a swirl lesson to play around in the R console to try things out. 
- `nxt()`: regain swirl's attention after `play()`ing around in the console. 
- `main()`: return to swirl's main menu. 
- `bye()`: exit swirl. Swirl will save your progress if you exit in the middle of a lesson. You can also hit the Esc. key to exit. (To re-enter swirl, run `swirl()`. In a new R session you will have to first load the swirl library: `library(swirl)`.)

#### For fun 

While they aren't required for class, you should consider trying out some other swirl lessons later in the course. The `Functions` lesson, as well as `lapply and sapply` and `vapply and tapply` could be particularly useful. You can also look through the [course directory](https://github.com/swirldev/swirl_courses) to see what other courses and lessons are available.  

If you are doing extra swirl courses on your own, you probably want to do them through the "R Programming", rather than the "R Programming E", course, since you won't need to let us know by email. To get this, you can run: 

```{r eval=FALSE}
library(swirl)
install_course("R_Programming")
swirl()
```

## Homework #2

**Due date: Sept. 28**

---
output: html_document
---

Homework 2 has two parts: for part 1, you need to recreate the following R Markdown document. The code chunks here have been hidden with the option `eval = FALSE`, but you should include your code in your final document. For part 2, you should create another R Markdown document analyzing an online data set of your choosing. (One option could be a different data set from FiveThirtyEight's [GitHub data page](https://github.com/fivethirtyeight/data).) The specific elements that need to be included in this second, custom R Markdown document are listed below under Part 2. 

### Part 1

Recreate the follwing in R Markdown, with your code included: 

#### Gender Bias in the Movie Biz 

In 1985, cartoonist [Alison Bechdel](http://dykestowatchoutfor.com/) proposed "The Rule." To pass, a movie has to sastisfy three basic requirements: 

1. It has to have at least two women in it,  
2. The two women have to talk to each other, and 
3. They have to talk to each other about something besides a man. 

"The Rule" (see a copy of the original comic strip [here](http://www.npr.org/templates/story/story.php?storyId=94202522)) is commonly refered to as the Bechdel test. It's a seemingly low bar, and it's surprising how many films **fail** the test. 

In 2014, [FiveThirtyEight](http://fivethirtyeight.com/) analyzed 1,615 films between 1990 and 2013 to explore the financial effect of a these films' portrayal of women in an article titled [The Dollar-And-Cents Case Against Hollywood’s Exclusion of Women](http://fivethirtyeight.com/features/the-dollar-and-cents-case-against-hollywoods-exclusion-of-women/). Their analysis relied on data sets from [BechdelTest.com](http://bechdeltest.com/) and [The-Numbers.com](http://www.the-numbers.com/). They concluded that the "the median bidget of movies that passed the test - those that featured a conversation between two women about something other than a man — was substantially lower than the median budget of all films in the sample." Overall, movies that passed the test may have a better financial return than those that don't. 

##### The data

The data set used by FiveThirtyEight is available for download [here](https://github.com/fivethirtyeight/data/blob/master/bechdel/movies.csv) from FiveThirtyEight's [GitHub data page](https://github.com/fivethirtyeight/data). Download and read in the data set, and look at the first few rows of the dataframe: 

```{r echo = FALSE}
setwd("~/Desktop")
movies <- read.csv("movies.csv", header = TRUE)

head(movies, 3) 
```

Here are the last few rows: 

```{r echo = FALSE}
tail(movies, 3)
```

Right now, the data set includes movies from 1970 to 2013. We want to make sure we only include movies that came out *after* 1990. Here are the new last few rows in the `year` and `title` columns:

```{r echo = FALSE}
library(dplyr)
movies <- movies[movies$year > 1989, ]
tail(select(movies, c(year, title)), 3)
```

We can probably clean up a few of the column names to make them easier to work with. Here are the current column names: 

```{r echo = FALSE}
colnames(movies)
```

It might be useful to rename "binary" to "Bechdel", and to remove the periods `.` from "budget_2013.", "domgross_2013.", and "intgross_2013.": 

```{r echo = FALSE}
library(dplyr)
movies <- rename(movies, Bechdel = binary) 
colnames(movies)[11:13] <- c("budget_2013", "domgross_2013", "intgross_2013")
colnames(movies)
```

##### "The Rule"

It looks like `binary` tells us whether a movie passed or failed. Here's how the count of movies that have failed and passed the test has changed over time: 

```{r echo = FALSE}
library(ggplot2)
ggplot(movies, aes(year, fill = Bechdel)) + geom_histogram(bins = 23) +
  ylab("count of movies") + 
  theme_minimal()
```

`clean_test` offers a finer detail of the Bechdel Test than Fail vs. Pass. Here are the different levels of this variable: 

```{r echo = FALSE}
unique(movies$clean_test)
```

Based on FiveThirtyEight's [article](http://fivethirtyeight.com/features/the-dollar-and-cents-case-against-hollywoods-exclusion-of-women/), it seems like these levels correspond to the following categories: 

```{r echo = FALSE}
library(knitr)
bechdel = data.frame(clean_test = c("nowomen", "notalk", "men", "dubious", "ok"), 
                     Category_Description = c("Fewer than two women", "Women don't talk to each other", "Women only talk about men", "Dubious", "Passes Bechdel Test"), 
                     Bechdel_Test = c("Fail", "Fail", "Fail", "Pass", "Pass"))

kable(bechdel, format = "markdown")
```

We can check out the median budget in 2013 dollars for movies fitting into each of these categories. First, create a dataframe with the median value of `budget_2013` for each movie (in ascending order) using `dplyr`'s `group_by()`, `summarize()`, and `arrange()` functions. Change the dollar amount so that its units are in millions of dollars. 

```{r echo = FALSE}
library(dplyr)

med_budget <- group_by(movies, clean_test) %>%
  summarize(median_budget_2013 = median(budget_2013)) %>%
  arrange(median_budget_2013)

med_budget <- med_budget %>% 
  mutate(median_budget_2013 = median_budget_2013 / 1000000)

med_budget
```

Next, for the purposes of later plotting, reorder the levels of `clean_test` so that they are in *descending* order, and rename them to more verbose descriptions: "Women don't talk to each other", "Fewer than two women", "Women only talk about men", "Pass (dubious)", and "Pass", for "notalk", "nowomen", "men", "dubious", and "ok", respectively. 

```{r echo = FALSE}
med_budget$clean_test <- factor(med_budget$clean_test, levels = c("notalk", "nowomen", 
                                                                  "men", "dubious", "ok"))

med_budget <- med_budget %>%
  mutate(clean_test = factor(clean_test, levels = c("notalk", "nowomen", "men", 
                                                    "dubious", "ok"), 
                             labels = c("Women don't talk to each other", 
                                        "Fewer than two women", 
                                        "Women only talk about men", 
                                        "Pass (dubious)", "Pass")))

med_budget
```

Add a column of corresponding Bechdel test results (one way to do this is to create a vector of "PASS" and "FAIL" values, and then `cbind` it to the dataframe): 

```{r echo = FALSE}
bechdel <- c("PASS", "PASS", "FAIL", "FAIL", "FAIL")
med_budget <- cbind(med_budget, bechdel)
med_budget
```

And finally, following [FiveThirtyEight's](http://fivethirtyeight.com/features/the-dollar-and-cents-case-against-hollywoods-exclusion-of-women/) lead, plot this dataframe as a bar graph:

```{r echo = FALSE}
library(dplyr)

ggplot(med_budget, aes(x = clean_test, y = median_budget_2013, fill = bechdel)) + 
  geom_bar(stat = "identity") + 
  scale_y_continuous("Meidan budget in 2013 dollars (millions)") + 
  xlab("Bechdel category") + 
  coord_flip() + 
  theme_minimal()
```

We can see that past movies that have failed the Bechdel test had higher median budgets. What about how much money these movies made? In FiveThirtyEight's analysis, they focused on "Return on investment", which involved dividing movie profits (`domgross_2013`, for example) by movie budgets. For simplicity's sake, let's compare domestic gross for movies that passed and failed the test. Again, we should `mutate` `domgross_2013` so that it is in units of millions of dollars. 

First, change `domgross_2013` to numeric class. Currently, it's saved as a factor: 

```{r echo = FALSE}
class(movies$domgross_2013)
```

First convert the column class to character, and then numeric. 

```{r echo = FALSE}
movies$domgross_2013 <- as.numeric(as.character(movies$domgross_2013))
```

Here's a boxplot comparing domestic gross for movies that failed and passed the Bechdel test: 

```{r echo = FALSE}
library(dplyr)
library(ggplot2)

movies <- movies %>% 
  mutate(domgross_2013 = domgross_2013 / 1000000)

box <- ggplot(movies, aes(x = Bechdel, y = domgross_2013, fill = Bechdel)) + 
  geom_boxplot() + 
  ylab("Domestic gross in 2013 dollars (millions)") + 
  theme_minimal() + 
  theme(legend.position = "none")
box
```

With a lot of outliers, it looks like the mean domestic gross for movies that failed is *slightly* higher than that for movies that passed. 

Let's find out what the highest grossing movies in "Pass" and "Fail" are. For failed, it looks like the higest grossing movie in this data set that failed the Bechdel test earned $825.7 million (in 2013 dollars):

```{r echo = FALSE}
fail <- subset(movies, Bechdel == "FAIL")
max(fail$domgross_2013, na.rm = TRUE)
```

And its title is "Avatar"!

```{r echo = FALSE}
subset(fail, domgross_2013 > 825)$title
```

For passed, it looks like "Titanic" made $955.9 million (in 2013 dollars). 

```{r echo = FALSE} 
pass <- subset(movies, Bechdel == "PASS")
max(pass$domgross_2013, na.rm = TRUE)
subset(pass, domgross_2013 > 955)$title
```

To wrap up, add both of these titles as interesting labels to the plot. (Note: to match the lables shown here, use `size = 4` and `hjust = 1.2` in your `geom_text()` addition.)

```{r echo = FALSE}
avatar <- subset(fail, domgross_2013 > 825)
titanic <- subset(pass, domgross_2013 > 955)

box + geom_text(data = avatar, 
                label = "Avatar", 
                size = 4, 
                hjust = 1.2) + 
  geom_text(data = titanic, 
            label = "Titanic", 
            size = 4, 
            hjust = 1.2)
```

### Part 2

Your custom R Markdown document, analyzing an online data set of your choosing, should include the following elements: 

1. Read in the data from online 

2. Include initial `head()` `tail()` and `summary()` results for your dataframe 

3. Manipulate/clean the data set with 3 to 4 `dplyr` and/or `tidyr` functions 

4. Include 1 to 2 `ggplot2` plots of the data 

The more explanation of what you're doing (and why) at each step, the better. Knit each R Markdown document to Word, and email them by the start of class on Wednesday, September 28. Please email me with any questions! -Rachel 

## Homework #3

**Due date: Oct. 12**

[`dplyr`, tidy data homework assignment]

## Homework #4

**Due date: Oct. 26**

[Advanced R Markdown homework assignment]

## Homework #5

**Due date: Nov. 9**

[Homework on functions, regular expressions, and web data assignment]

## Homework #6

**Due date: Nov. 30**

[Mapping homework assignment]